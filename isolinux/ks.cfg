# Kickstart file automatically generated by anaconda.

#version=DEVEL
install
#text
cmdline 
lang en_US.UTF-8
keyboard uk
network --onboot yes --bootproto dhcp --noipv6
timezone --utc Europe/London
rootpw --iscrypted $1$QIMfS35e$.Q4sMVQwFdlRftxC37BEZ/
user --name=admin --groups=wheel --homedir=/home/admin --iscrypted $1$QIMfS35e$.Q4sMVQwFdlRftxC37BEZ/
selinux --disabled
firstboot --disable
xconfig --defaultdesktop=KDE --startxonboot
reboot
authconfig --enableshadow --passalgo=sha512
clearpart --drives=sda --initlabel --linux
autopart
zerombr
bootloader --location=mbr --driveorder=sda --append="rhgb quiet"

%packages
@base
@core
@development-libs
@development-tools
@editors
@kde-desktop
@text-internet
@base-x
mtools
gpm
cmake
hdparm
gdm
%post
set -x -v
exec 1>/root/ks-post.log 2>&1

# create /etc/sysconfig/desktop (needed for installation)
cat > /etc/sysconfig/desktop <<EOF
DESKTOP="KDE"
DISPLAYMANAGER="KDE"
EOF

echo "------------------------------"
echo "Downloading ruby"
echo "------------------------------"
mkdir -p /var/tmp/src
cd /var/tmp/src/
wget -nv http://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.2-p290.tar.gz
tar xzf ruby-1.9.2-p290.tar.gz
cd ruby-1.9.2-p290

echo "------------------------------"
echo "Building ruby"
echo "------------------------------"
./configure
make -s && make -s install
[ -f /usr/bin/ruby ] && rm -f /usr/bin/ruby
[ -f /usr/bin/gem ] && rm -f /usr/bin/gem
ln -s /usr/local/bin/ruby /usr/bin/ruby
ln -s /usr/local/bin/gem /usr/bin/gem

echo "------------------------------"
echo "Cleaning up Ruby source"
echo "------------------------------"
cd -
rm -f /var/tmp/src/ruby-1.9.2-p290.tar.gz
rm -rf /var/tmp/src/ruby-1.9.2-p290

echo "------------------------------"
echo "Installing chef"
echo "------------------------------"
/usr/local/bin/gem install chef
/usr/local/bin/gem install ruby-shadow

%end

